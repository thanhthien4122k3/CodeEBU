# UDCNTT_HANU
---

# **Project: Xá»­ LÃ½ vÃ  Tá»•ng Há»£p Dá»¯ Liá»‡u Äiá»ƒm Sinh ViÃªn**

## MÃ´ táº£

Project nÃ y lÃ  má»™t script Python Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh xá»­ lÃ½ vÃ  tá»•ng há»£p dá»¯ liá»‡u Ä‘iá»ƒm thi cá»§a sinh viÃªn tá»« cÃ¡c file Excel. Script thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:

1.  **Äá»c dá»¯ liá»‡u:** Tá»± Ä‘á»™ng quÃ©t vÃ  Ä‘á»c dá»¯ liá»‡u Ä‘iá»ƒm tá»« nhiá»u file Excel náº±m trong má»™t thÆ° má»¥c chá»‰ Ä‘á»‹nh.
2.  **Chuáº©n hÃ³a dá»¯ liá»‡u:**
    *   Loáº¡i bá» cÃ¡c dÃ²ng dá»¯ liá»‡u bá»‹ trÃ¹ng láº·p dá»±a trÃªn mÃ£ sinh viÃªn.
    *   XÃ³a bá» nhá»¯ng sinh viÃªn cÃ³ Ä‘iá»ƒm khÃ´ng há»£p lá»‡ (vÃ­ dá»¥: Ä‘iá»ƒm khÃ´ng pháº£i sá»‘, hoáº·c cÃ¡c kÃ½ tá»± nhÆ° 'VT' - váº¯ng thi, 'CT' - cáº¥m thi).
    *   Äá»‹nh dáº¡ng chuáº©n cÃ¡c cá»™t Ä‘iá»ƒm (chuyá»ƒn Ä‘á»•i dáº¥u pháº©y thÃ nh dáº¥u cháº¥m vÃ  Ä‘áº£m báº£o Ä‘á»‹nh dáº¡ng sá»‘).
3.  **PhÃ¢n loáº¡i há»c lá»±c:** Tá»± Ä‘á»™ng phÃ¢n loáº¡i há»c lá»±c cá»§a sinh viÃªn dá»±a trÃªn Ä‘iá»ƒm trung bÃ¬nh mÃ´n há»c theo cÃ¡c má»©c Ä‘á»™: Xuáº¥t sáº¯c, Giá»i, KhÃ¡, Trung bÃ¬nh, Yáº¿u.
4.  **Tá»•ng há»£p dá»¯ liá»‡u:**
    *   Gá»™p dá»¯ liá»‡u tá»« nhiá»u file vÃ  sheet khÃ¡c nhau thÃ nh má»™t file duy nháº¥t.
    *   Táº¡o file riÃªng biá»‡t chá»©a cÃ¡c báº£n ghi khÃ´ng há»£p lá»‡ Ä‘á»ƒ dá»… dÃ ng kiá»ƒm tra vÃ  Ä‘á»‘i chiáº¿u.
5.  **Thá»‘ng kÃª quÃ¡ trÃ¬nh xá»­ lÃ½:** Xuáº¥t ra file thá»‘ng kÃª chi tiáº¿t vá» sá»‘ lÆ°á»£ng file vÃ  sheet Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½, giÃºp ngÆ°á»i dÃ¹ng dá»… dÃ ng theo dÃµi vÃ  kiá»ƒm soÃ¡t quÃ¡ trÃ¬nh.
6.  **Káº¿t há»£p dá»¯ liá»‡u giÃ¡o viÃªn:** Tá»± Ä‘á»™ng káº¿t há»£p thÃ´ng tin vá» giÃ¡o viÃªn giáº£ng dáº¡y tá»« má»™t file Excel khÃ¡c, giÃºp liÃªn káº¿t dá»¯ liá»‡u Ä‘iá»ƒm vá»›i thÃ´ng tin giÃ¡o viÃªn.

## Chá»©c nÄƒng chÃ­nh

*   **Tá»± Ä‘á»™ng hÃ³a xá»­ lÃ½ dá»¯ liá»‡u:** Giáº£m thiá»ƒu cÃ´ng sá»©c xá»­ lÃ½ thá»§ cÃ´ng cÃ¡c file Ä‘iá»ƒm sá»‘ lÆ°á»£ng lá»›n.
*   **LÃ m sáº¡ch vÃ  chuáº©n hÃ³a dá»¯ liá»‡u:** Äáº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c sáº¡ch sáº½ vÃ  á»Ÿ Ä‘á»‹nh dáº¡ng chuáº©n, sáºµn sÃ ng cho cÃ¡c phÃ¢n tÃ­ch tiáº¿p theo.
*   **PhÃ¢n loáº¡i há»c lá»±c tá»± Ä‘á»™ng:**  Nhanh chÃ³ng cÃ³ Ä‘Æ°á»£c cÃ¡i nhÃ¬n tá»•ng quan vá» phÃ¢n bá»‘ há»c lá»±c cá»§a sinh viÃªn.
*   **Tá»•ng há»£p dá»¯ liá»‡u Ä‘a nguá»“n:**  Dá»… dÃ ng táº­p há»£p dá»¯ liá»‡u tá»« nhiá»u nguá»“n khÃ¡c nhau vÃ o má»™t nÆ¡i duy nháº¥t.
*   **Cung cáº¥p thÃ´ng tin thá»‘ng kÃª:**  GiÃºp ngÆ°á»i dÃ¹ng náº¯m báº¯t Ä‘Æ°á»£c tÃ¬nh hÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u vÃ  cháº¥t lÆ°á»£ng dá»¯ liá»‡u Ä‘áº§u vÃ o.
*   **Káº¿t ná»‘i thÃ´ng tin giÃ¡o viÃªn:**  Má»Ÿ rá»™ng kháº£ nÄƒng phÃ¢n tÃ­ch dá»¯ liá»‡u báº±ng cÃ¡ch tÃ­ch há»£p thÃ´ng tin vá» giÃ¡o viÃªn.

## Ná»™i dung cÃ¡c file
* ğŸ“„ TKB_GV.xlsx (File TKB giÃ¡o viÃªn)
```
 Tá»« cá»™t A:G **pháº£i cÃ³ 3 cá»™t** (STT, Lá»›p vÃ  GiÃ¡o viÃªn) vÃ  tÃªn lÃ  "Thong ke gio day HK1"
   ![image](https://github.com/user-attachments/assets/35b39bb5-2b11-4e45-b5f0-92428c360d66)
```
*ğŸ“„ File Ä‘iá»ƒm 1.xlsx
```
Báº¯t buá»™c
+ Pháº£i cÃ³ dÃ²ng: 	Há»c kÃ¬ 1. nÄƒm há»c 2022-2023		MÃ´n: á»¨ng dá»¥ng CNTT 				NHÃ“M 01 

+ Pháº£i cÃ³ cÃ¡c cá»™t: STT, "Äiá»ƒm CC (10%)", "Äiá»ƒm GK (30%)", "Äiá»ƒm cuá»‘i ká»³ (60%)", MSSV, Ghi chÃº (LÆ°u Ã½: cÃ³ thá»ƒ khÃ´ng viáº¿t táº¯t cÅ©ng Ä‘Æ°á»£c)

![image](https://github.com/user-attachments/assets/e5e99a33-9f52-4861-b5a1-963ea43410da)

```

## YÃªu cáº§u

TrÆ°á»›c khi sá»­ dá»¥ng script nÃ y, báº¡n cáº§n Ä‘áº£m báº£o Ä‘Ã£ cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n Python sau:

```bash
pip install pandas unidecode openpyxl
```

*   **pandas**: ThÆ° viá»‡n máº¡nh máº½ Ä‘á»ƒ phÃ¢n tÃ­ch vÃ  thao tÃ¡c dá»¯ liá»‡u.
*   **unidecode**:  Äá»ƒ xá»­ lÃ½ vÃ  chuáº©n hÃ³a tÃªn giÃ¡o viÃªn, loáº¡i bá» dáº¥u tiáº¿ng Viá»‡t.
*   **openpyxl**: ThÆ° viá»‡n Ä‘á»ƒ Ä‘á»c vÃ  viáº¿t file Excel (Ä‘áº·c biá»‡t lÃ  `.xlsx`). Python cÃ³ thá»ƒ Ä‘Ã£ cÃ i Ä‘áº·t sáºµn thÆ° viá»‡n nÃ y, nhÆ°ng náº¿u gáº·p lá»—i báº¡n cÃ³ thá»ƒ cÃ i Ä‘áº·t thá»§ cÃ´ng.

NgoÃ i ra, báº¡n cáº§n cÃ³ cÃ¡c file dá»¯ liá»‡u Ä‘áº§u vÃ o theo cáº¥u trÃºc thÆ° má»¥c nhÆ° mÃ´ táº£ dÆ°á»›i Ä‘Ã¢y.

## HÆ°á»›ng dáº«n sá»­ dá»¥ng

### 1. Cáº¥u trÃºc thÆ° má»¥c

TrÆ°á»›c khi cháº¡y script, hÃ£y cháº¯c cháº¯n ráº±ng báº¡n Ä‘Ã£ thiáº¿t láº­p cáº¥u trÃºc thÆ° má»¥c nhÆ° sau:

```
ğŸ“ TÃªn thÆ° má»¥c gá»‘c (vÃ­ dá»¥: Mark_data)
â”œâ”€â”€ ğŸ“ DIEM THANH PHAN_KI 1, 2022_2023 (ThÆ° má»¥c chá»©a file Ä‘iá»ƒm gá»‘c)
â”‚   â”œâ”€â”€ ğŸ“„ File Ä‘iá»ƒm 1.xlsx
â”‚   â”œâ”€â”€ ğŸ“„ File Ä‘iá»ƒm 2.xls
â”‚   â””â”€â”€ ğŸ“„ ... (CÃ¡c file Ä‘iá»ƒm khÃ¡c)
â”œâ”€â”€ ğŸ“ Term1_2022_2023_processed (ThÆ° má»¥c Ä‘á»ƒ lÆ°u file Ä‘Ã£ xá»­ lÃ½)
â”‚   â””â”€â”€ (ThÆ° má»¥c nÃ y sáº½ Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng náº¿u chÆ°a tá»“n táº¡i)
â””â”€â”€ ğŸ“„ TKB_GV.xlsx (File TKB giÃ¡o viÃªn)
```

*   **`DIEM THANH PHAN_KI 1, 2022_2023`**: ThÆ° má»¥c chá»©a táº¥t cáº£ cÃ¡c file Excel Ä‘iá»ƒm thÃ nh pháº§n cá»§a sinh viÃªn á»Ÿ Ä‘á»‹nh dáº¡ng `.xlsx` hoáº·c `.xls`.
*   **`Term1_2022_2023_processed`**: ThÆ° má»¥c nÃ y sáº½ chá»©a cÃ¡c file káº¿t quáº£ sau khi script cháº¡y xong. Náº¿u thÆ° má»¥c nÃ y chÆ°a tá»“n táº¡i, script sáº½ tá»± Ä‘á»™ng táº¡o má»›i.
*   **`TKB_GV.xlsx`**: File Excel chá»©a thÃ´ng tin vá» thá»i khÃ³a biá»ƒu vÃ  giÃ¡o viÃªn, sá»­ dá»¥ng Ä‘á»ƒ ghÃ©p thÃ´ng tin giÃ¡o viÃªn vÃ o dá»¯ liá»‡u Ä‘iá»ƒm.

**LÆ°u Ã½ quan trá»ng:**

*   Äáº£m báº£o ráº±ng tÃªn cÃ¡c thÆ° má»¥c vÃ  file trong script trÃ¹ng khá»›p vá»›i tÃªn thá»±c táº¿ trÃªn mÃ¡y cá»§a báº¡n, hoáº·c báº¡n cáº§n chá»‰nh sá»­a láº¡i cÃ¡c Ä‘Æ°á»ng dáº«n trong code cho phÃ¹ há»£p.
*   CÃ¡c file Excel Ä‘iá»ƒm sinh viÃªn cáº§n cÃ³ cáº¥u trÃºc tÆ°Æ¡ng tá»± nhau, vá»›i header chá»©a cÃ¡c thÃ´ng tin nhÆ° 'STT', 'MÃ£ sinh viÃªn', 'Äiá»ƒm chuyÃªn cáº§n', 'Äiá»ƒm giá»¯a kÃ¬', 'Äiá»ƒm cuá»‘i kÃ¬', 'Ghi chÃº'. Script cÃ³ kháº£ nÄƒng tá»± Ä‘á»™ng nháº­n diá»‡n cÃ¡c cá»™t nÃ y dÃ¹ tÃªn cá»™t cÃ³ thá»ƒ khÃ¡c nhau má»™t chÃºt (vÃ­ dá»¥: 'MSSV' thay vÃ¬ 'MÃ£ sinh viÃªn').

### 2. Chá»‰nh sá»­a Ä‘Æ°á»ng dáº«n (náº¿u cáº§n)

Má»Ÿ file Python vÃ  kiá»ƒm tra cÃ¡c Ä‘Æ°á»ng dáº«n sau, Ä‘iá»u chá»‰nh náº¿u cáº§n thiáº¿t Ä‘á»ƒ phÃ¹ há»£p vá»›i vá»‹ trÃ­ thÆ° má»¥c vÃ  file trÃªn mÃ¡y tÃ­nh cá»§a báº¡n:

```python
# ÄÆ°á»ng dáº«n thÆ° má»¥c nguá»“n vÃ  Ä‘Ã­ch
folder_path = Path(r"D:\Visual Studio Coode\Python\FIT_UDCNTT\DIEM THANH PHAN_KI 1, 2022_2023")
processed_path = Path(r"D:\Visual Studio Coode\Python\FIT_UDCNTT\Mark_data\Term1_2022_2023_processed")
teacher_file_path = Path(r"D:\Visual Studio Coode\Python\FIT_UDCNTT\TKB_GV khoa.xlsx")
```

### 3. Cháº¡y script

Má»Ÿ terminal hoáº·c command prompt, Ä‘iá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c chá»©a file Python script vÃ  cháº¡y lá»‡nh:

```bash
python tÃªn_file_script.py
```

Thay `tÃªn_file_script.py` báº±ng tÃªn file Python cá»§a báº¡n.

### 4. Kiá»ƒm tra káº¿t quáº£

Sau khi script cháº¡y thÃ nh cÃ´ng, báº¡n sáº½ tÃ¬m tháº¥y cÃ¡c file káº¿t quáº£ trong thÆ° má»¥c `Term1_2022_2023_processed`:

*   **`Merged_Data.csv`**: File CSV chá»©a dá»¯ liá»‡u Ä‘iá»ƒm Ä‘Ã£ Ä‘Æ°á»£c tá»•ng há»£p, lÃ m sáº¡ch vÃ  chuáº©n hÃ³a cá»§a táº¥t cáº£ sinh viÃªn há»£p lá»‡ tá»« cÃ¡c file Ä‘áº§u vÃ o. File nÃ y Ä‘Ã£ bao gá»“m thÃ´ng tin vá» chuyÃªn ngÃ nh, Ä‘iá»ƒm trung bÃ¬nh mÃ´n há»c, xáº¿p loáº¡i há»c lá»±c, káº¿t quáº£ (Äá»—/TrÆ°á»£t) vÃ  thÃ´ng tin giÃ¡o viÃªn (náº¿u cÃ³).
*   **`INVALID_ALL.csv`**: File CSV chá»©a táº¥t cáº£ cÃ¡c báº£n ghi Ä‘iá»ƒm khÃ´ng há»£p lá»‡ tá»« cÃ¡c file Ä‘áº§u vÃ o. CÃ¡c báº£n ghi nÃ y cÃ³ thá»ƒ chá»©a lá»—i Ä‘á»‹nh dáº¡ng Ä‘iá»ƒm, thiáº¿u thÃ´ng tin Ä‘iá»ƒm, hoáº·c cÃ¡c lá»—i khÃ¡c. File nÃ y giÃºp báº¡n dá»… dÃ ng kiá»ƒm tra vÃ  Ä‘á»‘i chiáº¿u cÃ¡c trÆ°á»ng há»£p dá»¯ liá»‡u khÃ´ng há»£p lá»‡.
*   **`Processing_Stats.csv`**: File CSV chá»©a thá»‘ng kÃª chi tiáº¿t vá» quÃ¡ trÃ¬nh xá»­ lÃ½, bao gá»“m sá»‘ lÆ°á»£ng file Ä‘Ã£ xá»­ lÃ½, sá»‘ lÆ°á»£ng sheet trong má»—i file, vÃ  cÃ¡c sheet nÃ o Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½. File nÃ y cung cáº¥p cÃ¡i nhÃ¬n tá»•ng quan vá» quÃ¡ trÃ¬nh cháº¡y script vÃ  cÃ³ thá»ƒ giÃºp Ã­ch trong viá»‡c kiá»ƒm soÃ¡t cháº¥t lÆ°á»£ng dá»¯ liá»‡u Ä‘áº§u vÃ o.

## CÃ¡c hÃ m chÃ­nh

Script nÃ y bao gá»“m cÃ¡c hÃ m chÃ­nh sau:

*   **`check_dup(dataframe)`**: XÃ³a cÃ¡c báº£n ghi trÃ¹ng láº·p trong DataFrame dá»±a trÃªn cá»™t 'MÃ£ sinh viÃªn'.
*   **`Remove_student(dataframe)`**: Loáº¡i bá» sinh viÃªn cÃ³ Ä‘iá»ƒm khÃ´ng há»£p lá»‡ (khÃ´ng pháº£i sá»‘, 'VT', 'CT').
*   **`format_scores(dataframe)`**: Äá»‹nh dáº¡ng cÃ¡c cá»™t Ä‘iá»ƒm sá»‘ trong DataFrame.
*   **`Classify_performace(score)`**: PhÃ¢n loáº¡i há»c lá»±c dá»±a trÃªn Ä‘iá»ƒm trung bÃ¬nh.
*   **`format_teacher_name(full_name)`**: Chuáº©n hÃ³a tÃªn giÃ¡o viÃªn.
*   **`extract_group_number(df, sheet_name)`**: TrÃ­ch xuáº¥t sá»‘ nhÃ³m tá»« sheet.
*   **`extract_term_year(df)`**: TrÃ­ch xuáº¥t há»c ká»³ vÃ  nÄƒm há»c.
*   **`clean_notes_column(df)`**: LÃ m sáº¡ch cá»™t 'Ghi chÃº'.
*   **`process_student_data(raw_df, sheet_name, file_name)`**: HÃ m chÃ­nh xá»­ lÃ½ dá»¯ liá»‡u tá»« má»™t sheet, bao gá»“m chuáº©n hÃ³a, lÃ m sáº¡ch, phÃ¢n loáº¡i vÃ  tá»•ng há»£p dá»¯ liá»‡u.
*   **`add_to_merged_invalid(merged_df, new_invalid_df)`**:  ThÃªm dá»¯ liá»‡u khÃ´ng há»£p lá»‡ má»›i vÃ o DataFrame tá»•ng há»£p cÃ¡c báº£n ghi khÃ´ng há»£p lá»‡.

## LÆ°u Ã½

*   **Kiá»ƒm tra Ä‘Æ°á»ng dáº«n:** LuÃ´n Ä‘áº£m báº£o cÃ¡c Ä‘Æ°á»ng dáº«n file vÃ  thÆ° má»¥c trong script lÃ  chÃ­nh xÃ¡c.
*   **Cáº¥u trÃºc file Excel Ä‘áº§u vÃ o:** Script Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ hoáº¡t Ä‘á»™ng vá»›i cáº¥u trÃºc file Excel nháº¥t Ä‘á»‹nh. Náº¿u cáº¥u trÃºc file cá»§a báº¡n khÃ¡c biá»‡t Ä‘Ã¡ng ká»ƒ, cÃ³ thá»ƒ cáº§n chá»‰nh sá»­a script Ä‘á»ƒ phÃ¹ há»£p.
*   **File TKB giÃ¡o viÃªn (teacher\_file\_path):**  File nÃ y lÃ  tÃ¹y chá»n. Náº¿u báº¡n khÃ´ng cÃ³ file nÃ y hoáº·c khÃ´ng muá»‘n ghÃ©p thÃ´ng tin giÃ¡o viÃªn, báº¡n cÃ³ thá»ƒ bá» qua bÆ°á»›c nÃ y hoáº·c comment Ä‘oáº¡n code liÃªn quan Ä‘áº¿n xá»­ lÃ½ file giÃ¡o viÃªn. Script váº«n sáº½ hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng Ä‘á»ƒ xá»­ lÃ½ vÃ  tá»•ng há»£p dá»¯ liá»‡u Ä‘iá»ƒm sinh viÃªn.
*   **Backup dá»¯ liá»‡u gá»‘c:**  LuÃ´n nÃªn backup dá»¯ liá»‡u gá»‘c trÆ°á»›c khi cháº¡y script Ä‘á»ƒ trÃ¡nh máº¥t mÃ¡t dá»¯ liá»‡u khÃ´ng mong muá»‘n.
*   **Xá»­ lÃ½ lá»—i:** Script Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ má»™t sá»‘ lá»—i thÆ°á»ng gáº·p (vÃ­ dá»¥: lá»—i Ä‘á»c file, lá»—i Ä‘á»‹nh dáº¡ng dá»¯ liá»‡u). Tuy nhiÃªn, trong quÃ¡ trÃ¬nh sá»­ dá»¥ng, náº¿u gáº·p báº¥t ká»³ lá»—i nÃ o, hÃ£y kiá»ƒm tra thÃ´ng bÃ¡o lá»—i má»™t cÃ¡ch cáº©n tháº­n. Náº¿u cáº§n, báº¡n cÃ³ thá»ƒ liÃªn há»‡ vá»›i tÃ¡c giáº£ script Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£ thÃªm.

## TÃ¡c giáº£

[VÅ© Thanh ThiÃªn]

## NgÃ y

[06-02-2025]

---
